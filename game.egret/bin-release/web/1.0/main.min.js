var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),BodyPoint=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.Create=function(t,e,i){this.Color=e,i?(this.bodypoint=new egret.Shape,this.bodypoint.graphics.lineStyle(4,0),this.bodypoint.graphics.beginFill(e.Origin),this.bodypoint.graphics.drawCircle(0,0,t),this.bodypoint.graphics.endFill(),this.addChild(this.bodypoint)):(this.bodypoint=new egret.Shape,this.bodypoint.graphics.lineStyle(4,e.Bright),this.bodypoint.graphics.beginFill(e.Origin),this.bodypoint.graphics.drawCircle(0,0,t),this.bodypoint.graphics.endFill(),this.addChild(this.bodypoint))},e}(egret.Sprite);__reflect(BodyPoint.prototype,"BodyPoint");var Color=function(){function t(){this.OriginColor=[8069026,12000284,1668818,3046706,16361509,35195,16011550],this.BrightColor=[10233776,13840175,2201331,4431943,16498733,2533018,16740419],this.GetRandomColor()}return t.prototype.GetRandomColor=function(){var t=Math.floor(Math.random()*this.OriginColor.length);this.Origin=this.OriginColor[t],this.Bright=this.BrightColor[t]},t.prototype.GetColorNum=function(t){for(var e=0;e<this.OriginColor.length;e++)if(t.Origin===this.OriginColor[e])return e},t}();__reflect(Color.prototype,"Color");var Food=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.CreateFood=function(t,e,i,o,s,r){this.id=s,this.intake=r,this.food=new egret.Shape,this.color=new Color,this.color.Bright=this.color.BrightColor[o],this.color.Origin=this.color.OriginColor[o],this.FoodRadius=.2*t*r,this.food.graphics.beginFill(this.color.Origin),this.food.graphics.drawCircle(0,0,this.FoodRadius),this.food.graphics.endFill(),this.x=e,this.y=i,this.addChild(this.food);var n=egret.Tween.get(this.food);this.food.scaleX=.01,this.food.scaleY=.01,n.to({scaleX:1,scaleY:1},300)},e}(egret.Sprite);__reflect(Food.prototype,"Food");var LittleMap=function(t){function e(e,i,o,s){var r=t.call(this)||this;return r.snake_info={},r.Create(e,i,o,s),r}return __extends(e,t),e.prototype.Create=function(t,e,i,o){this.radius=i,this.ratio=o,this.width=t*o,this.height=e*o;var s=new egret.Sprite;this.addChild(s),s.x=0,s.y=0;var r=new egret.Shape;r.graphics.beginFill(16750592),r.graphics.drawRect(0,0,30,this.height),r.graphics.endFill(),s.addChild(r);for(var n=["M","a","p"],a=0;a<n.length;a++){var h=new egret.TextField;h.text=n[a],h.textColor=16777215,h.size=20,h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,h.x=s.width/2,h.y=a*(h.height+10)+(s.height-(3*h.height+20))/2,s.addChild(h)}this.MapBody=new egret.Sprite,this.MapBody.x=30,this.addChild(this.MapBody);var d=new egret.Shape;d.graphics.beginFill(16777215),d.graphics.drawRect(0,0,this.width,this.height),d.graphics.endFill(),d.alpha=.5,this.MapBody.addChild(d)},e.prototype.addSnakeOrModify=function(t,e){if(this.snake_info[t.id]){var i=egret.Tween.get(this.snake_info[t.id].object);this.snake_info[t.id].x=this.ratio*t.x,this.snake_info[t.id].y=this.ratio*t.y,i.to({x:this.ratio*t.x,y:this.ratio*t.y},e)}else if(t.mine===!0){var o=new egret.GlowFilter(6732650,1,10,10,2,3,!1,!1),s=new egret.Shape;s.graphics.beginFill(6732650),s.graphics.drawCircle(0,0,this.radius),s.graphics.endFill(),this.MapBody.addChild(s),s.filters=[o],s.x=this.ratio*t.x,s.y=this.ratio*t.y,s.scaleX=.01,s.scaleY=.01;var i=egret.Tween.get(s);i.to({scaleX:1,scaleY:1},e),this.snake_info[t.id]={object:s,x:this.ratio*t.x,y:this.ratio*t.y}}else{var o=new egret.GlowFilter(15684432,1,10,10,2,3,!1,!1),s=new egret.Shape;s.graphics.beginFill(15684432),s.graphics.drawCircle(0,0,this.radius),s.graphics.endFill(),this.MapBody.addChild(s),s.filters=[o],s.x=this.ratio*t.x,s.y=this.ratio*t.y,s.scaleX=.01,s.scaleY=.01;var i=egret.Tween.get(s);i.to({scaleX:1,scaleY:1},e),this.snake_info[t.id]={object:s,x:this.ratio*t.x,y:this.ratio*t.y}}},e.prototype.RemovePoint=function(t,e){if(void 0!==this.snake_info[t]){var i=this.snake_info[t].object,o=egret.Tween.get(i);o.to({scaleX:.01,scaleY:.01},e),egret.setTimeout(function(){this.MapBody.removeChild(i)},this,e),delete this.snake_info[t]}},e}(egret.Sprite);__reflect(LittleMap.prototype,"LittleMap");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.radius=10,e.foodnum=233,e.SnakeLength=50,e.foodadd=10,e.SnakeLineWidth=4,e.HitFlag=!1,e.interval=100,e.BackGroundWidth=5e3,e.BackGroundHeight=3e3,e.RankListWidth=300,e.RankListHeight=400,e.food=[],e.otherSnakes={},e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createGameScene,e),e}return __extends(e,t),e.prototype.GiveSnake=function(t){this.snake=t},e.prototype.GiveStage=function(){return this},e.prototype.createGameScene=function(){function t(t){i.snake=new Snake,i.snake.Create(t),i.BackGround.addChild(i.snake),i.BackGround.setChildIndex(i.snake,-999)}this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH,this.BackGround=new egret.Sprite,this.BackGround.width=this.BackGroundWidth,this.BackGround.height=this.BackGroundHeight,this.socket=io("http://"+window.location.hostname+":2222/");var e=new egret.Shape;e.graphics.beginFill(16119285),e.graphics.drawRect(0,0,this.BackGround.width,this.BackGround.height),e.graphics.endFill(),this.BackGround.addChild(e);var i=this;this.socket.emit("join"),this.socket.on("create",function(e){var o=JSON.parse(e);t(o),i.BackGround.x=-(i.snake.Head.x+i.snake.x)+i.stage.stageWidth/2,i.BackGround.y=-(i.snake.Head.y+i.snake.y)+i.stage.stageHeight/2,i.addChild(i.BackGround),i.LittleMap=new LittleMap(i.BackGround.width,i.BackGround.height,5,.1),i.addChild(i.LittleMap),i.LittleMap.anchorOffsetX=i.LittleMap.width,i.LittleMap.x=i.stage.stageWidth-40,i.LittleMap.y=10,i.setChildIndex(i.LittleMap,-999),i.RankList=new RankList(i.RankListWidth,i.RankListHeight),i.addChild(i.RankList),i.RankList.x=10,i.RankList.y=10,i.setChildIndex(i.RankList,-999)}),this.socket.on("other_join",function(t){var e=JSON.parse(t),o=new Snake;o.CreatOther(e),i.otherSnakes[e.id]=o,i.BackGround.addChild(o),i.BackGround.setChildIndex(o,-999)}),this.socket.on("allfood",function(t){var e=JSON.parse(t);e.forEach(function(t){var e=new Food;e.CreateFood(i.radius,t.x,t.y,t.color,t.id,t.intake),i.BackGround.addChild(e),i.BackGround.setChildIndex(e,1),i.food.push(e)})}),this.socket.on("other_eat",function(t,e,o){var s=i.GetFoodByID(t);if(null!=s){i.otherSnakes[e].ColorCount=JSON.parse(o);var r=i.otherSnakes[e].x+i.otherSnakes[e].Head.x,n=i.otherSnakes[e].y+i.otherSnakes[e].Head.y,a=egret.Tween.get(s[1]);a.to({x:r,y:n},100),egret.setTimeout(function(){i.BackGround.removeChild(s[1])},this,100),i.food.splice(s[0],1)}}),this.socket.on("other_snake",function(t){var e=JSON.parse(t);e.forEach(function(t){var e=new Snake;e.CreatOther(t),i.otherSnakes[t.id]=e,i.BackGround.addChild(e),i.BackGround.setChildIndex(e,-999)})}),this.socket.on("disconnect",function(t){if(void 0!==i.otherSnakes[t]){i.otherSnakes[t].RemoveSnake(),i.LittleMap.RemovePoint(t,80);setTimeout(function(){i.BackGround.removeChild(i.otherSnakes[t]),delete i.otherSnakes[t]},300)}}),this.socket.on("rebirth",function(t,e,o,s,r,n){console.log(t);var a=JSON.parse(s),h=JSON.parse(n);if(i.snake.id===t){for(var d=0;d<i.snake.BodyList.length;d++)for(var l=0;3>l;l++){var c=i.snake.BodyList[d].x+i.snake.x,y=i.snake.BodyList[d].y+i.snake.y,g=Math.random()*Math.PI,p=70*Math.random(),u=c+p*Math.cos(g),k=y+p*Math.sin(g);i.CreateParticle(c,y,u,k,e,o)}egret.Tween.removeTweens(i.BackGround);var f=egret.Tween.get(i.BackGround);if(f.to({x:-e+i.stage.stageWidth/2,y:-o+i.stage.stageHeight/2},4e3),i.snake.removeChildren(),r>0){var v=new RemoveTips;v.Create(r),v.textTips.width=i.stage.stageWidth,v.anchorOffsetX=v.width/2,v.anchorOffsetY=v.height/2,v.x=i.stage.stageWidth/2,v.y=i.stage.stageHeight/2-200,i.addChild(v),i.setChildIndex(v,-999),setTimeout(function(){i.removeChild(v)},100*r+2e3)}setTimeout(function(){i.snake.ReDraw(e,o,a),i.snake.AddPoint(h)},4e3)}else{for(var d=0;d<i.otherSnakes[t].BodyList.length;d++)for(var l=0;3>l;l++){var c=i.otherSnakes[t].BodyList[d].x+i.otherSnakes[t].x,y=i.otherSnakes[t].BodyList[d].y+i.otherSnakes[t].y,g=Math.random()*Math.PI,p=70*Math.random(),u=c+p*Math.cos(g),k=y+p*Math.sin(g);i.CreateParticle(c,y,u,k,e,o)}i.otherSnakes[t];i.otherSnakes[t].removeChildren(),setTimeout(function(){i.otherSnakes[t].ReDraw(e,o,a),i.otherSnakes[t].AddPoint(h)},4e3)}}),this.socket.on("AnimateAddFood",function(t,e,o,s){var r=JSON.parse(t);if("true"===e)i.DropBodyPoint(s,i.snake);else{var n=i.otherSnakes[o];void 0!==n&&i.DropBodyPoint(s,n)}r.forEach(function(t){t.x<=0||t.y<=0||t.x>=i.BackGround.width||t.y>=i.BackGround.height||i.BodytoFood(t.fromX,t.fromY,t.x,t.y,t.intake,t.color,t.id)})}),this.socket.on("move",function(t){var e=JSON.parse(t),o=i.otherSnakes[e.id];if(void 0!==o){o.OtherMove(e,80);var s={x:e.body[0].x+o.x,y:e.body[0].y+o.y,id:e.id,mine:!1};i.LittleMap.addSnakeOrModify(s,80)}}),this.socket.on("own_add_point",function(t,e){var o=JSON.parse(t);i.snake.AfterEat(o,e)}),this.socket.on("other_add_point",function(t,e,o){var s=JSON.parse(e),r=i.otherSnakes[t];void 0!==r&&r.AfterEat(s,o)}),this.socket.on("add_food_for_num",function(t){var e=JSON.parse(t);e.forEach(function(t){var e=new Food;e.CreateFood(i.radius,t.x,t.y,t.color,t.id,t.intake),i.BackGround.addChild(e),i.BackGround.setChildIndex(e,1),i.food.push(e)})}),this.GetMoveTimer=new egret.Timer(80),this.GetMoveTimer.addEventListener(egret.TimerEvent.TIMER,this.GetOtherMove,this),this.GetMoveTimer.start(),mouse.enable(this.stage),mouse.setMouseMoveEnabled(!0),this.BackGround.touchEnabled=!0,this.BackGround.addEventListener(mouse.MouseEvent.MOUSE_MOVE,this.OnMove,this),this.BackGround.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startTouchAccelerate,this),this.BackGround.addEventListener(egret.TouchEvent.TOUCH_END,this.endTouchAccelerate,this)},e.prototype.GetOtherMove=function(){var t=[];if(void 0!==this.snake){for(var e=0;e<this.snake.BodyList.length;e++){var i=void 0,o=new Color;i={id:this.snake.BodyList[e].id,x:this.snake.BodyList[e].x,y:this.snake.BodyList[e].y,color:o.OriginColor.indexOf(this.snake.BodyList[e].Color.Origin)},t.push(i)}this.socket.emit("move",JSON.stringify(t),this.snake.id);var s={id:this.snake.id,x:this.snake.BodyList[0].x+this.snake.x,y:this.snake.BodyList[0].y+this.snake.y,mine:!0};this.LittleMap.addSnakeOrModify(s,80);var r=0;for(var n in this.snake.ColorCount)r+=this.snake.ColorCount[n];var a=[{playercode:this.snake.playercode,length:15*this.snake.BodyList.length+r,mine:!0}];for(var n in this.otherSnakes){r=0;var h=this.otherSnakes[n].ColorCount;for(var d in h)r+=h[d];var l=void 0;l={playercode:this.otherSnakes[n].playercode,length:15*this.otherSnakes[n].BodyList.length+r,mine:!1},a.push(l)}this.RankList.Manager(a)}},e.prototype.OnMove=function(t){void 0!==this.snake&&(this.moveEvent=t,null==this.timer&&(this.timer=new egret.Timer(this.interval),this.timer.hasEventListener(egret.TimerEvent.TIMER)||this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.start()),this.snake.BodyList.length<=2&&this.endTouchAccelerate())},e.prototype.onEatFood=function(t){var e=this.food[t].color,i=this.food[t],o=egret.Tween.get(this.food[t]);o.to({x:this.snake.x+this.snake.Head.x,y:this.snake.y+this.snake.Head.y},100),egret.setTimeout(function(){this.BackGround.removeChild(i)},this,100);var s;if(s=this.food[t].id,this.snake.ColorCount[e.Origin]?this.snake.ColorCount[e.Origin]+=this.food[t].intake:this.snake.ColorCount[e.Origin]=this.food[t].intake,this.snake.ColorCount[e.Origin]>=15){var r={Ocolor:this.food[t].color.Origin,Bcolor:this.food[t].color.Bright};this.socket.emit("afterEat",this.snake.id,JSON.stringify(r)),this.snake.ColorCount[e.Origin]-=15}this.food.splice(t,1),this.socket.emit("eatfood",s,JSON.stringify(this.snake.ColorCount))},e.prototype.onTimer=function(){this.snake.BodyList.length<=2?(this.snake.bool=!1,this.HitFlag=!0):this.HitFlag===!0&&(this.snake.bool=!0,this.HitFlag=!1);for(var t=0;t<this.food.length;t++)if(this.hit(this.snake.Head,this.food[t])){this.onEatFood(t);break}var e=this.snake.Head.x,i=this.snake.Head.y,o=this.BackGround.x,s=this.BackGround.y,r=this.snake.Move(this.moveEvent,o,s,this.BackGroundWidth,this.BackGroundHeight,this.interval);if(null!==r){var n=egret.Tween.get(this.BackGround);n.to({x:this.BackGround.x-(r.x-e),y:this.BackGround.y-(r.y-i)},this.interval)}if(this.snake.bool===!0)for(var a in this.otherSnakes){var h=0,d=void 0;d=this.otherSnakes[a];for(var l=0;l<d.BodyList.length;l++){var c=this.snake.Head,y=void 0;if(y=new Object,y=this.snakeHeadCheck(c,d,l)){this.snake.bool=!1,this.socket.emit("rebirth",this.snake.id,this.snake.BodyList.length,0),h=1;break}}if(1===h)break}},e.prototype.CreateParticle=function(t,e,i,o,s,r){var n=new Particle;n.CreateParticle(t,e,i,o,s,r),this.BackGround.addChild(n);var a=this;return setTimeout(function(){a.BackGround.removeChild(n)},4e3),n},e.prototype.hit=function(t,e){return(t.x+this.snake.x-e.x)*(t.x+this.snake.x-e.x)+(t.y+this.snake.y-e.y)*(t.y+this.snake.y-e.y)<10*this.radius*this.radius?!0:!1},e.prototype.snakeHeadCheck=function(t,e,i){var o=4*this.radius*this.radius,s=t.x+this.snake.x-e.BodyList[i].x-e.x,r=t.y+this.snake.y-e.BodyList[i].y-e.y,n=s*s+r*r;return o>=n&&this.snake.bool?!0:!1},e.prototype.startTouchAccelerate=function(){void 0!==this.snake&&this.snake.BodyList.length>2&&(this.timer.delay=50,this.interval=50,this.startAccelerate())},e.prototype.endTouchAccelerate=function(){void 0!==this.snake&&(this.timer.delay=100,this.interval=100,this.stopAccelerate())},e.prototype.IfDropBody=function(){if(this.snake.count++,this.snake.BodyList.length<=2&&this.endTouchAccelerate(),this.snake.BodyList.length>2&&this.snake.count%100===0){var t=this.snake.BodyList[this.snake.BodyList.length-1],e={id:t.id,x:t.x+this.snake.x,y:t.y+this.snake.y,color:t.Color.OriginColor.indexOf(t.Color.Origin)};this.socket.emit("Drop",JSON.stringify(e)),this.snake.count=0}},e.prototype.startAccelerate=function(){void 0===this.snake.AccelerateTimer&&(this.snake.AccelerateTimer=new egret.Timer(30)),this.snake.AccelerateTimer.addEventListener(egret.TimerEvent.TIMER,this.IfDropBody,this),this.snake.AccelerateTimer.start()},e.prototype.stopAccelerate=function(){null!==this.snake.AccelerateTimer&&this.snake.AccelerateTimer.hasEventListener(egret.TimerEvent.TIMER)&&(this.snake.AccelerateTimer.stop(),this.snake.AccelerateTimer.removeEventListener(egret.TimerEvent.TIMER,this.IfDropBody,this))},e.prototype.BodytoFood=function(t,e,i,o,s,r,n){var a;a=new Food,a.CreateFood(this.radius,t,e,r,n,s),this.BackGround.addChild(a),this.BackGround.setChildIndex(a,1),this.food.push(a);var h=egret.Tween.get(a);h.to({x:i,y:o},500,egret.Ease.circOut)},e.prototype.GetFoodByID=function(t){for(var e=0;e<this.food.length;e++)if(this.food[e].id===t){var i=[];return i[0]=e,i[1]=this.food[e],i}return null},e.prototype.DropBodyPoint=function(t,e){for(var i,o,s=function(){if(e.BodyList[n].id===t){i=e.BodyList[n];var s=e.BodyList[n].Color,a=e.BodyList[n].x,h=e.BodyList[n].y;e.removeChild(i),e.BodyList.splice(n,1);var d=new BodyPoint;d.Create(r.radius,s,!1),d.x=e.x+a,d.y=e.y+h,r.BackGround.addChild(d),r.BackGround.setChildIndex(d,-999),o=egret.Tween.get(d),o.to({scaleX:.01,scaleY:.01,alaph:0},500,egret.Ease.circOut);var l=r;return setTimeout(function(){l.BackGround.removeChild(d)},500),"break"}},r=this,n=e.BodyList.length-1;n>=0;n--){var a=s();if("break"===a)break}return null},e.prototype.Rebirth=function(t){this.removeChild(this.snake),this.snake.removeChildren()},e.prototype.ReDraw=function(t,e,i,o){this.snake.ReDraw(e,i,o),this.addChild(this.snake);for(var s=[],r=0;r<this.snake.BodyList.length;r++){var n=void 0,a=new Color;n={id:this.snake.BodyList[r].id,x:this.snake.BodyList[r].x,y:this.snake.BodyList[r].y,color:a.OriginColor.indexOf(this.snake.BodyList[r].Color.Origin)},s.push(n)}},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Particle=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.CreateParticle=function(t,e,i,o,s,r){this.fromX=t,this.fromY=e,this.toX=i,this.toY=o,this.flytoX=s,this.flytoY=r,this.pointX=Math.random()*Math.max(i/2,s/2)+Math.min(i/2,s/2),this.pointY=Math.random()*Math.max(o/2,r/2)+Math.min(o/2,r/2);var n=new egret.Shape;n.graphics.beginFill(4244735),n.graphics.drawCircle(0,0,5),n.graphics.endFill();var a=new egret.GlowFilter(1638399,.3,10,10,2,3,!1,!1);n.filters=[a],n.x=0,n.y=0,this.x=t,this.y=e,this.addChild(n);var h=egret.Tween.get(this);h.to({x:i,y:o},1e3);var d=this;setTimeout(function(){egret.Tween.removeTweens(d);var t=egret.Tween.get(d);t.to({factor:1},3e3)},1e3)},Object.defineProperty(e.prototype,"factor",{get:function(){return 0},set:function(t){this.x=(1-t)*(1-t)*this.toX+2*t*(1-t)*this.pointX+t*t*this.flytoX,this.y=(1-t)*(1-t)*this.toY+2*t*(1-t)*this.pointY+t*t*this.flytoY},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(Particle.prototype,"Particle");var RankList=function(t){function e(e,i){var o=t.call(this)||this;return o.Create(e,i),o}return __extends(e,t),e.prototype.Create=function(t,e){this.width=t,this.height=e;var i=new egret.Shape;i.graphics.beginFill(16777215),i.graphics.drawRect(0,0,this.width,this.height),i.graphics.endFill(),i.alpha=.5,this.addChild(i);var o=new egret.Sprite;o.graphics.beginFill(16750592),o.graphics.drawRect(0,0,this.width,30),o.graphics.endFill(),this.addChild(o);var s=new egret.TextField;o.addChild(s),s.width=this.width,s.textAlign=egret.HorizontalAlign.CENTER,s.textColor=16777215,s.text="排行榜(Rank)",s.size=20,s.y=5,this.container=new egret.Sprite,this.container.height=e,this.container.width=t,this.container.y=35,this.addChild(this.container),this.setChildIndex(this.container,1)},e.prototype.Manager=function(t){this.container.removeChildren(),t.sort(function(t,e){return e.length-t.length});for(var e=0;e<t.length;e++){var i=new egret.TextField;i.text=e+1+".  "+t[e].playercode,t[e].mine===!0?i.textColor=6732650:i.textColor=15684432,i.size=20,i.x=10,i.y=30*e,i.width=2*this.width/3,i.textAlign=egret.HorizontalAlign.LEFT,this.container.addChild(i);var o=new egret.TextField;o.text=t[e].length,t[e].mine===!0?o.textColor=6732650:o.textColor=15684432,o.size=20,o.y=30*e,o.anchorOffsetX=o.width,o.x=this.width-10,o.width=1*this.width/3,o.textAlign=egret.HorizontalAlign.LEFT,this.container.addChild(o)}},e}(egret.Sprite);__reflect(RankList.prototype,"RankList");var RemoveTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.Create=function(t){var e=new egret.TextField;this.textTips=e,e.textAlign=egret.HorizontalAlign.CENTER,e.textAlign=egret.VerticalAlign.MIDDLE;var i=1;e.strokeColor=166097,e.stroke=4,e.size=50,this.addChild(e);for(var o=0;t>o;o++)setTimeout(function(){if(4===i){e.strokeColor=16754470;var t=egret.Tween.get(e);t.to({size:100},300,egret.Ease.backInOut)}else if(7===i){e.strokeColor=15684432;var t=egret.Tween.get(e);t.to({size:150},300,egret.Ease.backInOut)}e.text="X "+i++},100*o);setTimeout(function(){var t=egret.Tween.get(e);t.to({scaleX:.01,scaleY:.01},1e3,egret.Ease.backInOut)},100*t+1e3)},e}(egret.Sprite);__reflect(RemoveTips.prototype,"RemoveTips");var Snake=function(t){function e(){var e=t.call(this)||this;return e.BodyList=[],e.speed=15,e.ColorCount={},e.count=0,e.bool=!0,e.radius=10,e}return __extends(e,t),e.prototype.Create=function(t){this.id=t.id,this.playercode=t.code;var e=new Color;e.Origin=e.OriginColor[t.body[0].color],e.Bright=e.BrightColor[t.body[0].color],this.Head=new BodyPoint,this.Head.Create(this.radius,e,!0),this.bool=!0,this.SnakeName=new egret.TextField,this.SnakeName.size=15,this.SnakeName.text=this.playercode,this.SnakeName.textColor=0,this.SnakeName.height=15,this.SnakeName.textAlign=egret.HorizontalAlign.LEFT,this.Head.x=this.radius,this.Head.y=this.radius,this.Head.id=t.body[0].id,this.SnakeName.anchorOffsetX=this.SnakeName.width/2,this.SnakeName.x=this.Head.x,this.SnakeName.y=this.Head.y-30,this.x=t.x,this.y=t.y,this.BodyList.push(this.Head),this.Head.scaleX=.01,this.Head.scaleY=.01;var i=egret.Tween.get(this.Head);this.addChild(this.Head),i.to({scaleX:1,scaleY:1},300),this.setChildIndex(this.Head,-999),this.addChild(this.SnakeName),this.setChildIndex(this.SnakeName,-999);for(var o=1;o<t.body.length;o++){var s=new Color;s.Origin=e.OriginColor[t.body[o].color],s.Bright=e.BrightColor[t.body[o].color];var r=new BodyPoint;r.Create(this.radius,s,!1),r.x=this.radius,r.y=this.radius,r.id=t.body[o].id,this.BodyList.push(r),r.x=.01,r.y=.01,i=egret.Tween.get(r),this.addChild(r),i.to({scaleX:1,scaleY:1},300),this.setChildIndex(r,0)}},e.prototype.Move=function(t,e,i,o,s,r){var n,a=t.stageX-e,h=t.stageY-i,d=this.x+this.BodyList[0].x,l=this.y+this.BodyList[0].y;n=egret.Tween.get(this.BodyList[0]);var c=Math.sqrt((a-d)*(a-d)+(h-l)*(h-l)),y=(a-d)/c,g=(h-l)/c;if(y*c*y*c+g*c*g*c<=this.speed*this.speed)return null;var p,u=this.BodyList[0].x+this.speed*y,k=this.BodyList[0].y+this.speed*g;if(p={x:u,y:k},u+this.x-this.radius<=0||u+this.x+this.radius>=o||k+this.y-this.radius<=0||k+this.y+this.radius>=s)return null;n.to({x:u,y:k},r);var f=egret.Tween.get(this.SnakeName);f.to({x:u,y:k-30},r);for(var v=this.BodyList.length-1;v>=1;v--)n=egret.Tween.get(this.BodyList[v]),n.to({x:this.BodyList[v-1].x,y:this.BodyList[v-1].y},r);return p},e.prototype.AfterEat=function(t,e){var i=new BodyPoint,o=new Color;o.Bright=t.Bcolor,o.Origin=t.Ocolor,i.Create(this.radius,o,!1),i.id=e,i.x=this.BodyList[this.BodyList.length-1].x+this.radius,i.y=this.BodyList[this.BodyList.length-1].y+this.radius,i.scaleX=.01,i.scaleY=.01,this.BodyList.push(i),this.addChild(i);var s=egret.Tween.get(i);s.to({scaleX:1,scaleY:1},500,egret.Ease.circOut),this.setChildIndex(this.BodyList[this.BodyList.length-1],0)},e.prototype.ReDraw=function(t,e,i){this.bool=!0;var o=new Color;this.Head.Color.Origin=o.OriginColor[i[0]],this.Head.Color.Bright=o.BrightColor[i[0]],this.Head.bodypoint.graphics.clear(),this.Head.bodypoint.graphics.lineStyle(4,0),this.Head.bodypoint.graphics.beginFill(this.BodyList[0].Color.Origin),this.Head.bodypoint.graphics.drawCircle(0,0,this.radius),egret.Tween.removeTweens(this.Head),this.Head.x=t-this.x,this.Head.y=e-this.y,this.Head.scaleX=.01,this.Head.scaleY=.01;var s=egret.Tween.get(this.Head);this.addChild(this.Head),s.to({scaleX:1,scaleY:1},300),this.addChild(this.Head),egret.Tween.removeTweens(this.SnakeName),this.SnakeName.x=this.Head.x,this.SnakeName.y=this.Head.y-30,this.addChild(this.SnakeName),this.setChildIndex(this.SnakeName,-999);for(var r=1;r<this.BodyList.length;r++){var n=new Color;this.BodyList[r].Color.Origin=n.OriginColor[i[r]],this.BodyList[r].Color.Bright=n.BrightColor[i[r]],this.BodyList[r].bodypoint.graphics.clear(),this.BodyList[r].bodypoint.graphics.lineStyle(4,this.BodyList[r].Color.Bright),this.BodyList[r].bodypoint.graphics.beginFill(this.BodyList[r].Color.Origin),this.BodyList[r].bodypoint.graphics.drawCircle(0,0,this.radius),egret.Tween.removeTweens(this.BodyList[r]),this.BodyList[r].x=t-this.x,this.BodyList[r].y=e-this.y,this.BodyList[r].scaleX=.01,this.BodyList[r].scaleY=.01,s=egret.Tween.get(this.BodyList[r]),this.addChild(this.BodyList[r]),s.to({scaleX:1,scaleY:1},300),this.setChildIndex(this.BodyList[r],0)}},e.prototype.CreatOther=function(t){this.id=t.id,this.playercode=t.code,this.Head=new BodyPoint;var e=new Color;e.Origin=e.OriginColor[t.body[0].color],e.Bright=e.BrightColor[t.body[0].color],this.Head.Create(this.radius,e,!0),this.Head.x=this.radius,this.Head.y=this.radius,this.Head.id=t.body[0].id,this.SnakeName=new egret.TextField,this.SnakeName.size=15,this.SnakeName.text=this.playercode,this.SnakeName.textColor=0,this.SnakeName.height=15,this.SnakeName.textAlign=egret.HorizontalAlign.LEFT,this.SnakeName.anchorOffsetX=this.SnakeName.width/2,this.SnakeName.x=this.Head.x,this.SnakeName.y=this.Head.y-30,this.addChild(this.SnakeName),this.setChildIndex(this.SnakeName,-999),this.x=t.x,this.y=t.y,this.BodyList.push(this.Head),this.Head.scaleX=.01,this.Head.scaleY=.01;var i=egret.Tween.get(this.Head);this.addChild(this.Head),i.to({scaleX:1,scaleY:1},300),this.setChildIndex(this.Head,-999);for(var o=1;o<t.body.length;o++){var s=new BodyPoint,r=new Color;r.Origin=r.OriginColor[t.body[o].color],r.Bright=r.BrightColor[t.body[o].color],s.Create(this.radius,r,!1),s.x=t.body[o].x,s.y=t.body[o].y,s.id=t.body[o].id,this.BodyList.push(s),s.scaleX=.01,s.scaleY=.01,i=egret.Tween.get(s),this.addChild(s),i.to({scaleX:1,scaleY:1},300),this.setChildIndex(s,0)}},e.prototype.OtherMove=function(t,e){for(var i=0;i<Math.min(t.body.length,this.BodyList.length);i++){var o=egret.Tween.get(this.BodyList[i]);o.to({x:t.body[i].x,y:t.body[i].y},e);var s=egret.Tween.get(this.SnakeName);s.to({x:t.body[0].x,y:t.body[0].y-30},e)}},e.prototype.OtherAddPoint=function(t,e,i,o){var s=new BodyPoint,r=new Color;r.Bright=o,r.Origin=i,s.Create(this.radius,r,!1),s.x=t-this.x,s.y=e-this.y,s.scaleX=.01,s.scaleY=.01,this.BodyList.push(s),this.addChild(s);var n=egret.Tween.get(s);n.to({scaleX:1,scaleY:1},500,egret.Ease.circOut),this.setChildIndex(this.BodyList[this.BodyList.length-1],0)},e.prototype.RemoveSnake=function(){this.BodyList.forEach(function(t){var e=egret.Tween.get(t);e.to({scaleX:.01,scaleY:.01},300)})},e.prototype.addSinglePoint=function(t,e,i,o,s,r){var n=new Color;if(n.Bright=s,n.Origin=r,t.bodypoint.graphics.clear(),t.bodypoint.graphics.lineStyle(4,s),t.bodypoint.graphics.beginFill(r),t.bodypoint.graphics.drawCircle(0,0,this.radius),t.bodypoint.graphics.endFill(),egret.Tween.removeTweens(t),t.x=i-this.x,t.y=o-this.y,e<=this.BodyList.length-1){var a=this.getChildIndex(this.BodyList[e-1]);this.addChildAt(t,a),this.BodyList.splice(e,0,t)}else{var a=this.getChildIndex(this.BodyList[e-1]);this.addChildAt(t,a),this.BodyList.push(t)}},e.prototype.ZumaRemove=function(t,e){var i;i=new Object;var o,s=t,r=t;for(t===this.BodyList.length&&t--,s=t,o=this.BodyList[t].Color.Origin,console.log(s);this.BodyList[s].Color.Origin===o&&s;)s--;if((s||this.BodyList[s].Color.Origin!==o)&&s++,2>s&&(s=2),e>r)for(;this.BodyList[r].Color.Origin===o&&e>r&&(r++,r!==e););if(r-s>2){for(var n=s;r>n;n++)this.removeChild(this.BodyList[n]);return this.BodyList.splice(s,r-s),i.size=e+s-r,i.head=s,i.last=r,i.judge=1,i}return i.head=s,i.last=r,i.judge=0,i},e.prototype.otherZumaRemove=function(t,e){if(e-t>2){for(var i=t;e>i;i++)this.removeChild(this.BodyList[i]);this.BodyList.splice(t,e-t)}},e.prototype.bodypointModify=function(t,e){this.Head.bodypoint.graphics.clear(),this.Head.bodypoint.graphics.lineStyle(4,this.Head.Color.Bright),this.Head.bodypoint.graphics.beginFill(this.Head.Color.Origin),this.Head.bodypoint.graphics.drawCircle(0,0,this.radius),this.Head.bodypoint.graphics.endFill(),this.Head.x=t,this.Head.y=e},e.prototype.headChange=function(){this.Head=this.BodyList[0],this.Head.bodypoint.graphics.clear(),this.Head.bodypoint.graphics.lineStyle(4,0),this.Head.bodypoint.graphics.beginFill(this.Head.Color.Origin),this.Head.bodypoint.graphics.drawCircle(0,0,this.radius),this.Head.bodypoint.graphics.endFill()},e.prototype.AddPoint=function(t){var e=this;t.forEach(function(t){var i=new BodyPoint,o=new Color;o.Bright=o.BrightColor[t.color],o.Origin=o.OriginColor[t.color],i.Create(e.radius,o,!1),i.id=t.id,i.x=e.BodyList[e.BodyList.length-1].x+e.radius,i.y=e.BodyList[e.BodyList.length-1].y+e.radius,e.BodyList.push(i),e.addChild(i),e.setChildIndex(e.BodyList[e.BodyList.length-1],0)})},e}(egret.Sprite);__reflect(Snake.prototype,"Snake");